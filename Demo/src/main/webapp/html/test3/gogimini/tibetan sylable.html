<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>藏文拆字工具</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Tibetan:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Noto Sans Tibetan', sans-serif;
        }
        #input-text {
            font-family: 'Noto Sans Tibetan', sans-serif;
        }
        #output-text {
            font-family: 'Noto Sans Tibetan', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 flex justify-center items-start min-h-screen py-8">
    <div class="container max-w-3xl bg-white shadow-lg rounded-lg p-6">
        <h1 class="text-2xl font-semibold text-blue-600 text-center mb-4">藏文拆字工具</h1>
        <p class="text-gray-700 text-center mb-4">输入藏文句子或词语，点击“拆字”按钮查看其组成部分。</p>

        <div class="mb-4">
            <label for="input-text" class="block text-gray-700 text-sm font-bold mb-2">输入藏文:</label>
            <textarea id="input-text" placeholder="输入藏文句子或词语..." class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></textarea>
        </div>

        <div class="mb-4">
            <button id="拆字" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">拆字</button>
        </div>

        <div class="mb-4">
            <label for="output-text" class="block text-gray-700 text-sm font-bold mb-2">拆字结果:</label>
            <textarea id="output-text" placeholder="拆字结果将显示在这里..." class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></textarea>
        </div>

        <div id="error-message" class="text-red-500 text-xs italic" style="display: none;"></div>
    </div>

    <script>
        const inputText = document.getElementById("input-text");
        const outputText = document.getElementById("output-text");
        const analyzeButton = document.getElementById("拆字");
        const errorMessage = document.getElementById("error-message");

        function displayErrorMessage(message) {
            errorMessage.textContent = message;
            errorMessage.style.display = "block";
        }

        function hideErrorMessage() {
            errorMessage.style.display = "none";
            errorMessage.textContent = ""; // Clear message
        }

        // 藏文音节分析函数
        function analyzeTibetanSyllable(syllable) {
            const parts = {
                rootLetter: "",
                prefix: "",
                suffix1: "",
                suffix2: "",
                vowel: "",
                aboveLetter: "", // གོང་འོག
                belowLetter: "", // འོག་འདོན
            };

            // ཨཱ་, ཨི་, ཨུ་ 转换为  ཨ + ཱ/ི/ུ
            syllable = syllable.replace(/ཱ/g, '་a');
            syllable = syllable.replace(/ི/g, '་i');
            syllable = syllable.replace(/ུ/g, '་u');

            // Regex for Tibetan syllable structure (simplified)
            const regex = /^([ཀ-ཧ])?([ཀ-ཧ])?([ཀ-ཧ])([ཱིེོུ]?)([ཀ-ཧ])?([ཀ-ཧ])?$/;
            const match = syllable.match(regex);

            if (match) {
                parts.prefix = match[1] || "";
                parts.aboveLetter = match[2] || "";
                parts.rootLetter = match[3] || "";
                parts.vowel = match[4] || "";
                parts.suffix1 = match[5] || "";
                parts.suffix2 = match[6] || "";
            } else {
              const vowelMatch = syllable.match(/([ཱིེོུ])/);
                if(vowelMatch){
                    parts.vowel = vowelMatch[1];
                    parts.rootLetter = syllable.replace(vowelMatch[1],'');
                }
                else{
                    parts.rootLetter = syllable;
                }
            }

            return parts;
        }

        // 拆字函数
        function analyzeTibetanText(text) {
            if (!text.trim()) {
                return "请输入藏文句子或词语。";
            }

            const syllables = text.split(/[\s་།\n]+/); // Split by spaces, tsek, and newlines
            let result = "";

            syllables.forEach((syllable, index) => {
                if (syllable) { // 确保音节不为空
                    const parts = analyzeTibetanSyllable(syllable);
                    result += `${index + 1}. 音节: ${syllable}\n`;
                    result += `   基字: ${parts.rootLetter || "-"}\n`;
                    result += `   前缀: ${parts.prefix || "-"}\n`;
                    result += `   上加字: ${parts.aboveLetter || "-"}\n`;
                    result += `   下加字: ${parts.belowLetter || "-"}\n`;
                    result += `   元音: ${parts.vowel || "-"}\n`;
                    result += `   后缀1: ${parts.suffix1 || "-"}\n`;
                    result += `   后缀2: ${parts.suffix2 || "-"}\n\n`;
                }
            });
            return result;
        }

        // 事件监听器
        analyzeButton.addEventListener("click", () => {
            hideErrorMessage();
            const text = inputText.value;
            const result = analyzeTibetanText(text);
            outputText.value = result;
        });
    </script>
</body>
</html>

// 个人评价：
// 逻辑非常清晰，结构紧凑，代码可读性非常好

<!-- 代码说明

### HTML (<body>)
- `input-text`：用户输入藏文文本的文本框。
- `拆字`：点击后分析文本的按钮。
- `output-text`：显示分析结果的文本框。
- `error-message`：显示错误信息的区域

### CSS (<style>)
- `font-family: 'Noto Sans Tibetan', sans-serif;`：为网页设置藏文字体。
- 使用 Tailwind CSS 进行基本的页面布局和样式设置。

### JavaScript (<script>)
- `analyzeTibetanSyllable(syllable)`：此函数接受一个藏文音节，并将其分解为基字、前缀、后缀等。使用正则表达式来匹配藏文音节的结构，并提取相关部分。
- `analyzeTibetanText(text)`：此函数接受藏文文本，将其拆分为音节，然后使用 `analyzeTibetanSyllable()` 函数分析每个音节，并将结果连接成一个字符串。
- `analyzeButton.addEventListener("click", ...)`：此事件监听器在点击“拆字”按钮时触发。它从输入文本框中获取藏文文本，调用 `analyzeTibetanText()` 
函数来分析文本，并将结果显示在输出文本框中。如果输入为空，则显示错误消息。

### 错误处理
如果用户尝试分析空文本，将显示一条适当的错误消息。

这个代码提供了一个基本的藏文文本分析工具，能够将藏文分解成音节，并识别每个音节的组成部分。
